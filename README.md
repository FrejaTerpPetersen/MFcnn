# DataDrivenMultiFidelityTechniquesForPDEs
This Github repository holds all code for the thesis: 'Data Driven Multi-Fidelity Techniques for Solving PDEs' by Freja Terp Petersen, Technical University of Denmark, Jan. 2024.

#### Citation (BibTex link in the menu on the right):

Petersen, F. (2024). DataDrivenMultiFidelityTechniquesForPDEs [Computer software]. https://github.com/FrejaTerpPetersen/DataDrivenMultiFidelityTechniquesForPDEs.

#### Use of this Github:
This repository can be cloned in order to consult and execute the scripts used for the Masters thesis. Do not submit any push- or merge-requests, as these will be rejected. 

#### Requirements:
An environment file (.yml) is found in the repository. This holds the python packages and their versions used for generating the code. The .yml file can be used for creating a Conda environment. 

## Overview
This README file introduces the files available in this github repository. The repository was developed during a Masters thesis project at the Technical University of Denmark. It does contain files that are not used in the thesis, but which were used during the project. Therefore, some folders might not be cleaned up properly for public use, but this README file gives an overview of the relevant files.

All model trainings have been finalized. Therefore, if you wish to clone the project and run the code, you DO NOT need to perform any trainings in order to run plot-scripts etc, as these trainings might take a long time. If you run a training script, it will overwrite the saved models, and subsequent plot generations will not correspond to the plots presented in the thesis.


The scripts of this thesis have to be called in a certain order (read more below). The script **call_script.sh** holds the entire flow of the thesis and keeps track of the order of the scripts. Consult this script if you are planning on running any code yourself.


## Folder structure
- **Thesis_Code:** Holds all code used in the thesis.
  - Data: Holds data generated by data-generation scripts
  - figs: Holds figures generated by figure-generation scripts. Holds all figures generated for the thesis.
  - Matlab: Holds Matlab code relevant for solving the Shallow Water Equations. Note: Matlab code for the Navier-Stokes equation is not available.
  - models: Holds pytorch files with model weights for all models generated in the thesis.
  - Workspaces: holds workspaces with parameters for calling certain scripts.
- **HPC:** Holds scripts used for model trainings on a remote machine. 

Note: When running scripts, make sure that your path is set to the folder holding the Github repository. 


## Code structure: Thesis_Code folder

The folder 'Thesis_Code' holds code used in the thesis. Prefices are used to indicate the topic of the script. Some scripts have a suffix indicating the equation. For instance, the script: MFcnn_train_NSE.py trains CNN-based MF-models for the Navier-Stokes equations (NSE). 

Overview of prefices:
- theory: relates to the introduction to the test PDEs in chapter 2.
- simple_MF: relates to the simple MF-models introduced in chapter 4.
- DeepFDM: relates to work on the Deep FDM introduced in chapter 4.
- MFcnn: relates to the novel MF-model introduced in chapter 5.


Overview of suffices:
- _SWE: shallow water equations
- _LSWE: linear shallow water equations
- _NSE: Navier-Stokes equation


Some scripts do not have prefices. Overview:
- functions.py: [Used across all scripts] Holds functions used in the above scripts
- networks.py:  [Used across all scripts] Holds class definitions for CNNs and finite difference methods.
- convolution1D.py: [Tutorial code] Holds the code introduced in listing 3.1 for time discretization using a convolution operation
- train_FDM.py: [Tutorial code] Holds the code introduced in listing 3.3 for training a simple CNN to match a FDM.
- convergence_check.py: Holds the code for doing the convergence tests of implementations of numerical solvers for test PDEs. Introduced in chapter 3. 


### IMPORTANT: call_script.py
Once again, it is stressed that the flow for calling scripts is found in the script **call_script.sh**. Open this script and find terminal prompts used for calling the individual scripts. **IT IS NOT RECOMMENDED** to call the shell-script directly, since this will cause all scripts to be executed subsequently. This is not recommended, since it will take a very long time (at least a couple days) and cause all models and figures to be overwritten. The purpose of the shell script is simply to provide an overview. Copy the prompts from here into a terminal to execute the scripts. 





